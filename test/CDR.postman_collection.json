{
	"info": {
		"_postman_id": "b1feeeb5-1b9b-418c-aed1-9b38b01abe24",
		"name": "DISI CDR",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Bootstrap",
			"item": [
				{
					"name": "Organizations",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/fhir+json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"resourceType\": \"Bundle\",\r\n  \"type\": \"transaction\",\r\n  \"entry\": [\r\n    {\r\n      \"resource\": {\r\n        \"resourceType\": \"Organization\",\r\n        \"id\": \"HIVOrganizationExample\",\r\n        \"meta\": {\r\n          \"profile\": [\r\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-organization\"\r\n          ]\r\n        },\r\n        \"address\": [\r\n          {\r\n            \"country\": \"DISI country\",\r\n            \"state\": \"DISI state 1\",\r\n            \"district\": \"DISI district 1\",\r\n            \"city\": \"DISI city 1\",\r\n            \"line\": [\r\n              \"DISI line 1\",\r\n              \"DISI line 2\",\r\n              \"DISI line 3\"\r\n            ],\r\n            \"postalCode\": \"DISI postal code\"\r\n          }\r\n        ],\r\n        \"name\": \"HIV Organization\",\r\n        \"identifier\": [\r\n          {\r\n            \"system\": \"http://test.org/identifier/hiv-organization\",\r\n            \"value\": \"facility1\"\r\n          }\r\n        ]\r\n      },\r\n      \"request\": {\r\n        \"method\": \"PUT\",\r\n        \"url\": \"Organization/HIVOrganizationExample\"\r\n      }\r\n    },\r\n    {\r\n      \"resource\": {\r\n        \"resourceType\": \"Organization\",\r\n        \"id\": \"HIVOrganizationExample2\",\r\n        \"meta\": {\r\n          \"profile\": [\r\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-organization\"\r\n          ]\r\n        },\r\n        \"address\": [\r\n          {\r\n            \"country\": \"DISI country\",\r\n            \"state\": \"DISI state 1\",\r\n            \"district\": \"DISI district 2\",\r\n            \"city\": \"DISI city 2\",\r\n            \"line\": [\r\n              \"DISI line 1\",\r\n              \"DISI line 2\",\r\n              \"DISI line 3\"\r\n            ],\r\n            \"postalCode\": \"DISI postal code 2\"\r\n          }\r\n        ],\r\n        \"name\": \"HIV Organization 2\",\r\n        \"identifier\": [\r\n          {\r\n            \"system\": \"http://test.org/identifier/hiv-organization\",\r\n            \"value\": \"facility2\"\r\n          }\r\n        ]\r\n      },\r\n      \"request\": {\r\n        \"method\": \"PUT\",\r\n        \"url\": \"Organization/HIVOrganizationExample2\"\r\n      }\r\n    },\r\n    {\r\n      \"resource\": {\r\n        \"resourceType\": \"Organization\",\r\n        \"id\": \"HIVOrganizationExample3\",\r\n        \"meta\": {\r\n          \"profile\": [\r\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-organization\"\r\n          ]\r\n        },\r\n        \"address\": [\r\n          {\r\n            \"country\": \"DISI country\",\r\n            \"state\": \"DISI state 2\",\r\n            \"district\": \"DISI district 3\",\r\n            \"city\": \"DISI city 3\",\r\n            \"line\": [\r\n              \"DISI line 1\",\r\n              \"DISI line 2\",\r\n              \"DISI line 3\"\r\n            ],\r\n            \"postalCode\": \"DISI postal code 3\"\r\n          }\r\n        ],\r\n        \"name\": \"HIV Organization 3\",\r\n        \"identifier\": [\r\n          {\r\n            \"system\": \"http://test.org/identifier/hiv-organization\",\r\n            \"value\": \"facility3\"\r\n          }\r\n        ]\r\n      },\r\n      \"request\": {\r\n        \"method\": \"PUT\",\r\n        \"url\": \"Organization/HIVOrganizationExample3\"\r\n      }\r\n    }\r\n  ]\r\n}"
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/fhir/",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"fhir",
								""
							]
						}
					},
					"response": []
				},
				{
					"name": "Locations",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/fhir+json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n  \"resourceType\": \"Bundle\",\r\n  \"type\": \"transaction\",\r\n  \"entry\": [\r\n    {\r\n      \"resource\": {\r\n        \"resourceType\": \"Location\",\r\n        \"id\": \"HIVLocationExample\",\r\n        \"meta\": {\r\n          \"profile\": [\r\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-Location\"\r\n          ]\r\n        },\r\n        \"address\": [\r\n          {\r\n            \"country\": \"DISI country\",\r\n            \"state\": \"DISI state 1\",\r\n            \"district\": \"DISI district 1\",\r\n            \"city\": \"DISI city 1\",\r\n            \"line\": [\r\n              \"DISI line 1\",\r\n              \"DISI line 2\",\r\n              \"DISI line 3\"\r\n            ],\r\n            \"postalCode\": \"DISI postal code\"\r\n          }\r\n        ],\r\n        \"name\": \"HIV Location\",\r\n        \"identifier\": [\r\n          {\r\n            \"system\": \"http://test.org/identifier/hiv-Location\",\r\n            \"value\": \"facility1\"\r\n          }\r\n        ],\r\n        \"position\": {\r\n          \"longitude\": 24.1,\r\n          \"latitude\": -30\r\n        }\r\n      },\r\n      \"request\": {\r\n        \"method\": \"PUT\",\r\n        \"url\": \"Location/HIVLocationExample\"\r\n      }\r\n    },\r\n    {\r\n      \"resource\": {\r\n        \"resourceType\": \"Location\",\r\n        \"id\": \"HIVLocationExample2\",\r\n        \"meta\": {\r\n          \"profile\": [\r\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-Location\"\r\n          ]\r\n        },\r\n        \"address\": [\r\n          {\r\n            \"country\": \"DISI country\",\r\n            \"state\": \"DISI state 1\",\r\n            \"district\": \"DISI district 2\",\r\n            \"city\": \"DISI city 2\",\r\n            \"line\": [\r\n              \"DISI line 1\",\r\n              \"DISI line 2\",\r\n              \"DISI line 3\"\r\n            ],\r\n            \"postalCode\": \"DISI postal code 2\"\r\n          }\r\n        ],\r\n        \"name\": \"HIV Location 2\",\r\n        \"identifier\": [\r\n          {\r\n            \"system\": \"http://test.org/identifier/hiv-Location\",\r\n            \"value\": \"facility2\"\r\n          }\r\n        ],\r\n        \"position\": {\r\n          \"longitude\": 24,\r\n          \"latitude\": -30.1\r\n        }\r\n      },\r\n      \"request\": {\r\n        \"method\": \"PUT\",\r\n        \"url\": \"Location/HIVLocationExample2\"\r\n      }\r\n    },\r\n    {\r\n      \"resource\": {\r\n        \"resourceType\": \"Location\",\r\n        \"id\": \"HIVLocationExample3\",\r\n        \"meta\": {\r\n          \"profile\": [\r\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-Location\"\r\n          ]\r\n        },\r\n        \"address\": [\r\n          {\r\n            \"country\": \"DISI country\",\r\n            \"state\": \"DISI state 2\",\r\n            \"district\": \"DISI district 3\",\r\n            \"city\": \"DISI city 3\",\r\n            \"line\": [\r\n              \"DISI line 1\",\r\n              \"DISI line 2\",\r\n              \"DISI line 3\"\r\n            ],\r\n            \"postalCode\": \"DISI postal code 3\"\r\n          }\r\n        ],\r\n        \"name\": \"HIV Location 3\",\r\n        \"identifier\": [\r\n          {\r\n            \"system\": \"http://test.org/identifier/hiv-Location\",\r\n            \"value\": \"facility3\"\r\n          }\r\n        ],\r\n        \"position\": {\r\n          \"longitude\": 24.1,\r\n          \"latitude\": -30.1\r\n        }\r\n      },\r\n      \"request\": {\r\n        \"method\": \"PUT\",\r\n        \"url\": \"Location/HIVLocationExample3\"\r\n      }\r\n    }\r\n  ]\r\n}"
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/fhir/",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"fhir",
								""
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "MPI interactions",
			"item": [
				{
					"name": "Register random patient",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"let headerValue = pm.response.headers.get(\"location\")",
									"pm.collectionVariables.set(\"extPatientRef\", headerValue);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/fhir+json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resourceType\": \"Patient\",\n  \"meta\": {\n    \"profile\": [\n      \"http://openhie.org/fhir/StructureDefinition/hiv-patient\"\n    ]\n  },\n  \"identifier\": [\n    {\n      \"system\": \"https://instantopenhie.org/client{{randomClientId}}\",\n      \"value\": \"{{$guid}}\"\n    }\n  ],\n  \"active\": true,\n  \"name\": [\n    {\n      \"use\": \"official\",\n      \"given\": [\n        \"{{$randomFirstName}}\"\n      ],\n      \"family\": \"{{$randomLastName}}\"\n    }\n  ],\n  \"gender\": \"{{gender}}\",\n  \"birthDate\": \"{{birthDate}}\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/client/Patient",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"client",
								"Patient"
							]
						}
					},
					"response": []
				},
				{
					"name": "Register duplicate patient - facility 1",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"let headerValue = pm.response.headers.get(\"location\")",
									"pm.collectionVariables.set(\"extPatientRef\", headerValue);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/fhir+json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resourceType\": \"Patient\",\n  \"meta\": {\n    \"profile\": [\n      \"http://openhie.org/fhir/StructureDefinition/hiv-patient\"\n    ]\n  },\n  \"identifier\": [\n    {\n      \"system\": \"https://instantopenhie.org/client1\",\n      \"value\": \"{{$guid}}\"\n    }\n  ],\n  \"active\": true,\n  \"name\": [\n    {\n      \"use\": \"official\",\n      \"given\": [\n        \"Jane\"\n      ],\n      \"family\": \"Smith\"\n    }\n  ],\n  \"gender\": \"female\",\n  \"birthDate\": \"1986-06-04\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/client/Patient",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"client",
								"Patient"
							]
						}
					},
					"response": []
				},
				{
					"name": "Register duplicate patient - facility 2",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"let headerValue = pm.response.headers.get(\"location\")",
									"pm.collectionVariables.set(\"extPatientRef\", headerValue);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/fhir+json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resourceType\": \"Patient\",\n  \"meta\": {\n    \"profile\": [\n      \"http://openhie.org/fhir/StructureDefinition/hiv-patient\"\n    ]\n  },\n  \"identifier\": [\n    {\n      \"system\": \"https://instantopenhie.org/client2\",\n      \"value\": \"{{$guid}}\"\n    }\n  ],\n  \"active\": true,\n  \"name\": [\n    {\n      \"use\": \"official\",\n      \"given\": [\n        \"Jaane\"\n      ],\n      \"family\": \"Smiith\"\n    }\n  ],\n  \"gender\": \"female\",\n  \"birthDate\": \"1986-06-04\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/client/Patient",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"client",
								"Patient"
							]
						}
					},
					"response": []
				},
				{
					"name": "Register duplicate patient - facility 3 - (manual link)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"let headerValue = pm.response.headers.get(\"location\")",
									"pm.collectionVariables.set(\"extPatientRef\", headerValue);",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"type": "text",
								"value": "application/fhir+json"
							},
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resourceType\": \"Patient\",\n  \"meta\": {\n    \"profile\": [\n      \"http://openhie.org/fhir/StructureDefinition/hiv-patient\"\n    ]\n  },\n  \"identifier\": [\n    {\n      \"system\": \"https://instantopenhie.org/client3\",\n      \"value\": \"{{$guid}}\"\n    }\n  ],\n  \"active\": true,\n  \"name\": [\n    {\n      \"use\": \"official\",\n      \"given\": [\n        \"Jan\"\n      ],\n      \"family\": \"Smthxxyz\"\n    }\n  ],\n  \"gender\": \"female\",\n  \"birthDate\": \"1986-06-04\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/client/Patient",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"client",
								"Patient"
							]
						},
						"description": "Will create a patient that needs manual action to be matched with other patients from the request above in OpenCR."
					},
					"response": []
				}
			]
		},
		{
			"name": "Submit bundle",
			"item": [
				{
					"name": "Submit random bundle",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/fhir+json",
								"type": "text"
							},
							{
								"key": "Authorization",
								"value": "Custom test",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"resourceType\": \"Bundle\",\n  \"type\": \"transaction\",\n  \"entry\": [\n    {\n      \"fullUrl\": \"Composition/HIVCompositionExample\",\n      \"resource\": {\n        \"resourceType\": \"Composition\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-composition\"\n          ]\n        },\n        \"type\": {\n          \"coding\": [\n            {\n              \"code\": \"95412-3\",\n              \"system\": \"http://loinc.org\"\n            }\n          ]\n        },\n        \"status\": \"final\",\n        \"identifier\": {\n          \"system\": \"http://test.org/identifier/hiv-case-report\",\n          \"value\": \"1111\"\n        },\n        \"encounter\": {\n          \"reference\": \"Encounter/HIVEncounterExample\"\n        },\n        \"date\": \"2021-05-18\",\n        \"title\": \"HIV Case Report\",\n        \"section\": [\n          {\n            \"title\": \"hivPatient\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"code\": \"hivPatient\",\n                  \"system\": \"http://test.org/sectionCode\"\n                }\n              ]\n            },\n            \"entry\": [\n              {\n                \"reference\": \"Patient/HIVPatientExample\"\n              }\n            ]\n          },\n          {\n            \"title\": \"maritalStatus\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"code\": \"maritalStatus\",\n                  \"system\": \"http://test.org/sectionCode\"\n                }\n              ]\n            },\n            \"entry\": [\n              {\n                \"reference\": \"Observation/MaritalStatusExample\"\n              }\n            ]\n          },\n          {\n            \"title\": \"hivDiagnosis\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"code\": \"hivDiagnosis\",\n                  \"system\": \"http://test.org/sectionCode\"\n                }\n              ]\n            },\n            \"entry\": [\n              {\n                \"reference\": \"Condition/HIVDiagnosisExample\"\n              }\n            ]\n          },\n          {\n            \"title\": \"viralLoad\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"code\": \"viralLoad\",\n                  \"system\": \"http://test.org/sectionCode\"\n                }\n              ]\n            },\n            \"entry\": [\n              {\n                \"reference\": \"Observation/ViralLoadExample\"\n              }\n            ]\n          },\n          {\n            \"title\": \"cd4\",\n            \"code\": {\n              \"coding\": [\n                {\n                  \"code\": \"cd4\",\n                  \"system\": \"http://test.org/sectionCode\"\n                }\n              ]\n            },\n            \"entry\": [\n              {\n                \"reference\": \"Observation/CD4Example\"\n              }\n            ]\n          }\n        ]\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"Encounter/HIVEncounterExample\",\n      \"resource\": {\n        \"resourceType\": \"Encounter\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-encounter\"\n          ]\n        },\n        \"serviceProvider\": {\n          \"reference\": \"Organization/{{orgId}}\"\n        },\n        \"status\": \"finished\",\n        \"class\": {\n          \"code\": \"ACUTE\",\n          \"system\": \"http://terminology.hl7.org/CodeSystem/v3-ActCode\"\n        },\n        \"period\": {\n          \"start\": \"{{encounterDate}}\",\n          \"end\": \"{{encounterDate}}\"\n        },\n        \"subject\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        }\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"Patient/HIVPatientExample\",\n      \"resource\": {\n        \"resourceType\": \"Patient\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-patient\"\n          ]\n        },\n        \"extension\": [\n          {\n            \"url\": \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/gender-identity\",\n            \"valueCodeableConcept\": {\n              \"coding\": [\n                {\n                  \"code\": \"{{gender}}\"\n                }\n              ]\n            }\n          },\n          {\n            \"url\": \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/key-population\",\n            \"valueCodeableConcept\": {\n              \"coding\": [\n                {\n                  \"code\": \"transgender\"\n                }\n              ]\n            }\n          }\n        ],\n        \"active\": true,\n        \"name\": [\n          {\n            \"use\": \"official\",\n            \"given\": [\n              \"{{$randomFirstName}}\"\n            ],\n            \"family\": \"{{$randomLastName}}\"\n          }\n        ],\n        \"gender\": \"{{gender}}\",\n        \"birthDate\": \"{{birthDate}}\",\n        \"telecom\": [\n          {\n            \"system\": \"phone\",\n            \"value\": \"+27825556666\"\n          }\n        ],\n        \"address\": [\n          {\n            \"country\": \"South Africa\",\n            \"state\": \"Western Province\",\n            \"district\": \"City of Cape Town\",\n            \"city\": \"Cape Town\"\n          }\n        ],\n        \"identifier\": [\n          {\n            \"system\": \"https://instantopenhie.org/client{{randomClientId}}\",\n            \"value\": \"{{$guid}}\"\n          },\n          {\n            \"value\": \"ART1234567\"\n          },\n          {\n            \"value\": \"NAT1234567\"\n          },\n          {\n            \"value\": \"EMR1234567\"\n          }\n        ],\n        \"link\": [\n          {\n            \"other\": {\n              \"reference\": \"RelatedPerson/GuardianExample\"\n            },\n            \"type\": \"seealso\"\n          }\n        ]\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"RelatedPerson/GuardianExample\",\n      \"resource\": {\n        \"resourceType\": \"RelatedPerson\",\n        \"name\": [\n          {\n            \"given\": [\n              \"Peter\"\n            ],\n            \"family\": \"Loo\"\n          }\n        ],\n        \"patient\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        }\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"Observation/MaritalStatusExample\",\n      \"resource\": {\n        \"resourceType\": \"Observation\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/marital-status\"\n          ]\n        },\n        \"status\": \"final\",\n        \"code\": {\n          \"coding\": [\n            {\n              \"code\": \"M\",\n              \"display\": \"Married\"\n            }\n          ]\n        },\n        \"subject\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        },\n        \"valueCodeableConcept\": {\n          \"coding\": [\n            {\n              \"code\": \"M\",\n              \"display\": \"Married\"\n            }\n          ]\n        }\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"Condition/HIVDiagnosisExample\",\n      \"resource\": {\n        \"resourceType\": \"Condition\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-diagnosis\"\n          ]\n        },\n        \"clinicalStatus\": {\n          \"coding\": [\n            {\n              \"code\": \"active\"\n            }\n          ]\n        },\n        \"verificationStatus\": {\n          \"coding\": [\n            {\n              \"code\": \"confirmed\"\n            }\n          ]\n        },\n        \"code\": {\n          \"coding\": [\n            {\n              \"code\": \"86406008\",\n              \"system\": \"http://snomed.info/sct\"\n            }\n          ]\n        },\n        \"subject\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        },\n        \"recordedDate\": \"{{hivPositiveDate}}\"\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"CarePlan/ARVTreatmentExample\",\n      \"resource\": {\n        \"resourceType\": \"CarePlan\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-arv-treatment\"\n          ]\n        },\n        \"status\": \"active\",\n        \"intent\": \"plan\",\n        \"subject\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        },\n        \"period\": {\n          \"start\": \"2021-05-20\"\n        }\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"Observation/ViralLoadExample\",\n      \"resource\": {\n        \"resourceType\": \"Observation\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-viral-load-test\"\n          ]\n        },\n        \"code\": {\n          \"coding\": [\n            {\n              \"code\": \"VL-RESULT\",\n              \"system\": \"http://test.org/obs\",\n              \"display\": \"Viral load result\"\n            }\n          ]\n        },\n        \"status\": \"final\",\n        \"subject\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        },\n        \"valueInteger\": 200,\n        \"interpretation\": [\n          {\n            \"coding\": [\n              {\n                \"code\": \"D\"\n              }\n            ]\n          }\n        ]\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    },\n    {\n      \"fullUrl\": \"Observation/CD4Example\",\n      \"resource\": {\n        \"resourceType\": \"Observation\",\n        \"meta\": {\n          \"profile\": [\n            \"http://openhie.org/fhir/hiv-casereporting/StructureDefinition/hiv-cd4-test\"\n          ]\n        },\n        \"code\": {\n          \"coding\": [\n            {\n              \"code\": \"CD4-RESULT\",\n              \"system\": \"http://test.org/obs\",\n              \"display\": \"CD4 result\"\n            }\n          ]\n        },\n        \"status\": \"final\",\n        \"subject\": {\n          \"reference\": \"Patient/HIVPatientExample\"\n        },\n        \"valueInteger\": 200\n      },\n      \"request\": {\n        \"method\": \"POST\"\n      }\n    }\n  ]\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/fhir",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"fhir"
							]
						},
						"description": "Remove author and ARVTherapySummaryExample section reference"
					},
					"response": []
				},
				{
					"name": "Submit random CSV",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"type": "text",
								"value": "Custom test"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "registration.firstName,registration.lastName,registration.gender,registration.birthDate,registration.keyPopulationStatus,registration.clientSourceId,registration.facilityCode,registration.address.country,registration.address.state,registration.address.district,registration.address.city,registration.tel,registration.NID,registration.guardianName,hivDiagnosis.hivPosDate,hivDiagnosis.hivPosFacilityCode,hivDiagnosis.hivPosUID,hivDiagnosis.recencyTestConducted,hivDiagnosis.recencyStatus,entryToCare.enrollmentDate,entryToCare.UID,entryToCare.facilityCode,entryToCare.dateOfFirstClinicalVisit,artInitiation.dateInitiated,artInitiation.regimenLine,artInitiation.regimen,cd4.collectionDate,cd4.result,cd4.percentage,artRegimenSwitch.date,artRegimenSwitch.line,artRegimenSwitch.regimen,viralSuppression.date,viralSuppression.result,viralSuppression.interpretation,viralSuppression.currentStatus,death.date,death.ageAtDeath,death.dateOfLastVisit,death.cause\n{{$randomFirstName}},{{$randomLastName}},{{gender}},{{birthDate}},FSW,{{$guid}},facility{{randomClientId}},DISI country,DISI state 1,DISI district 1,DISI city 1,555678889,1234567890,{{$randomFirstName}} {{$randomLastName}},{{hivPositiveDate}},facility{{randomClientId}},11111,Yes,Recent,2010-04-11,22222,facility{{randomClientId}},2010-04-12,2010-05-10,First line,TDF/3TC/DTG,2010-02-12|2010-04-12,180|200,25|30,2015-11-02|2018-01-22,First line|Second line,TDF/3TC/DTG|TDF/3TC/EFV,2010-05-05|2015-11-02|2018-02-23,1500|600|200,Detectable|Detectable|Non Detectable,Non Detectable,{{deathDate}},{{ageAtDeath}},,\n",
							"options": {
								"raw": {
									"language": "text"
								}
							}
						},
						"url": {
							"raw": "http://{{openhimHost}}:{{openhimPort}}/csv",
							"protocol": "http",
							"host": [
								"{{openhimHost}}"
							],
							"port": "{{openhimPort}}",
							"path": [
								"csv"
							]
						},
						"description": "Remove author and ARVTherapySummaryExample section reference"
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"const moment = require('moment');",
					"",
					"function getRandomInt(min, max) {",
					"    min = Math.ceil(min);",
					"    max = Math.floor(max);",
					"    return Math.floor(Math.random() * (max - min + 1)) + min;",
					"}",
					"",
					"pm.variables.set('randomClientId', getRandomInt(1, 3))",
					"",
					"const visitDate = moment().subtract((Math.random() * 10), 'years')",
					"const hivPositiveDate = visitDate.format('YYYY-MM-DD');",
					"pm.variables.set('hivPositiveDate', hivPositiveDate)",
					"pm.variables.set('artStartDate', moment(visitDate).add(getRandomInt(0, 10), 'days').format('YYYY-MM-DD'))",
					"pm.variables.set('encounterDate', visitDate.toISOString())",
					"",
					"const age = (Math.random() * 70)",
					"pm.variables.set('birthDate', moment(visitDate).subtract(age, 'years').format('YYYY-MM-DD'))",
					"",
					"const gender = ['male', 'female']",
					"pm.variables.set('gender', gender[getRandomInt(0, 1)])",
					"",
					"const orgs = ['HIVOrganizationExample', 'HIVOrganizationExample2', 'HIVOrganizationExample3']",
					"pm.variables.set('orgId', orgs[getRandomInt(0, 2)])",
					"",
					"if (Math.random() > 0.9) {",
					"  const deathDate = moment(visitDate).add(getRandomInt(5, 30), 'days')",
					"  pm.variables.set('deathDate', deathDate.format('YYYY-MM-DD'))",
					"  pm.variables.set('ageAtDeath', age)",
					"} else {",
					"  pm.variables.set('deathDate', '')",
					"  pm.variables.set('ageAtDeath', '')",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "extPatientRef",
			"value": "Patient/123"
		},
		{
			"key": "localPatientID",
			"value": ""
		},
		{
			"key": "openhimHost",
			"value": "localhost"
		},
		{
			"key": "openhimPort",
			"value": "5001"
		}
	]
}